# Как это должно работать
- Слушаем все эвенты от чатвута.
- Работаем ТОЛЬКО с диалогом в статусе pending
- Тыкание эндпойнтов по изменению статуса / региона / прочего - всё из dify.

# Чего пока нет
- Удаление диалогов в дифи (надо решить в какой момент делать)
- Создание своих диалогов (эндпойнты позволяют, но нужен айди контакта)

# Иметь в виду
После того как назначается тима бот уже не может сводобно дёргать эндпойнты с инфой о дилаоге, в том числе и custom attributes. При этом он даже может их апдейтить, но не читать.

# Как деплоить [WIP]

Важно : ссылку на вебхук надо прописать для Agent Bot в Super Admin консоли chatwoot : `Outgoing url
https://<ссылка на bridge>/api/v1/chatwoot-webhook`

Ссылка на корень сервиса должна быть в env vars пайплайна в dify `bridge_api_url = https:///<ссылка на bridge>/api/v1`

Локально docker-compose up должно хватить.

# Как тестить
В health.py живёт совсем базовое.
При локальном деплое:
1) Убедиться что заполнен .env
2) прописать туда `TEST_CONVERSATION_ID=<айдишник дилога, видно в логах и dev tools браузера>`, написав боту со своего акка.
3) `uv pip install -e ".[dev]"` (uv прекрасный пакетный мендежер для питона на rust : https://docs.astral.sh/uv/getting-started/installation/)
4) `python -m pytest`
